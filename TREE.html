
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TREE.js</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
  
    <style>
    #container{
		width:500px
	}
	body{
		background-color:green;
		background-image:url('http://31.media.tumblr.com/tumblr_ljpji3Bc8o1qisa2ko1_1280.jpg');

	}
    </style>
	</head>
	<body>

		<div id="container"></div>
		<div id="info"  style="font-family:sans-serif;font-size:.2em;color:white">
			<span id="mouseInfoX">x: y:</span><br>
			<span id="mouseInfoY">x: y:</span>
		</div>

		<input type="button" id="buttonid" value="saveObj" style="width:175px"onclick="saver()" style="padding:10"><br>

		<script src="lib/three.js"></script>


		<script src="sketches/sc17_radial.js"></script>

		<script src="lib/library.js"></script>

		<script src="lib/TREE.js"></script>
	

		<script>
		
	
			var camera, controls, scene, renderer, 
				mouseX, mouseY, omouseX, omouseY, pmouseX, pmouseY, opmouseX, opmouseY, rmouseX, rmouseY, mousePressed,
				pmx, pmy,
				frameRate,pause;

			var tree;

			var clock = new THREE.Clock();
			clock.start();
			var time = clock.getElapsedTime();
			var count;

			var thing = [];

			init();
			
			window.addEventListener('load', function() { animate();}, false)

			function init() {

				frameRate = 1000/30;
				pause = false;

				count=0;

				pmx = pmy = [];

				mouseX= mouseY= omouseX= omouseY= pmouseX= pmouseY= opmouseX= opmouseY = 0;
				mousePressed = false;

				camera = new THREE.PerspectiveCamera( 30, window.innerWidth / window.innerHeight, 1, 10000 );
				camera.position.z = 650;

				controls = new THREE.OrbitControls( camera );
				// controls.addEventListener( 'change', render );

				scene = new THREE.Scene();
				// scene.fog = new THREE.FogExp2( 0x000000, 0.0004 );

				sc1.setup();
					
				light = new THREE.DirectionalLight( 0x4444444 );
				light.position.set( 1, 1, .5 );
				scene.add( light );
				
				light = new THREE.DirectionalLight( 0x555555 );
				light.position.set( -1, 1, .5 );
				scene.add( light );
				
				light = new THREE.DirectionalLight( 0x555555 );
				light.position.set( 0, 1, 1 );
				scene.add( light );
				
				light = new THREE.DirectionalLight( 0x666666 );
				light.position.set( 0, 1, -1 );
				scene.add( light );

				light = new THREE.DirectionalLight( 0x334477,1,0 );
				light.position.set( -1, -1, -1 );
				scene.add( light );
				
				// light = new THREE.DirectionalLight( 0x556699,1,0 );
				// light.position.set( 1, -1, 1 );
				// scene.add( light );

				// light = new THREE.AmbientLight( 0x222222 );
				// scene.add( light );

				renderer = new THREE.WebGLRenderer( { clearColor: 0xff0000, antialias: true ,alpha: true } );
				renderer.setClearColor( 0x000000, 0);


// var renderer = new THREE.WebGLRenderer( { alpha: true } );
				// renderer.setClearColor( scene.fog.color, 1 );
				renderer.setSize( window.innerWidth-20, window.innerHeight-70);
				
				container = document.getElementById( 'container' );
				container.appendChild( renderer.domElement );

				window.addEventListener( 'resize', onWindowResize, false );

			}

			function onWindowResize() {
			
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();
				renderer.setSize( window.innerWidth, window.innerHeight );
			}

			function animate() {

				setTimeout(function(){

					var time = clock.getElapsedTime();

					render();

					count++;
					pm(4);

					if(!pause)
						sc1.draw(-time);

					setSpan("mouseInfoX","mouseX: " + truncateDecimals(mouseX,3) + " rmouseX: " + rmouseX + " omouseX: " + truncateDecimals(omouseX,3));
					setSpan("mouseInfoY","mouseY: " + truncateDecimals(mouseY,3) + " rmouseY: " + rmouseY + " omouseY: " + truncateDecimals(omouseY,3));

					requestAnimationFrame( animate );
					controls.update();

				},frameRate)
				
			}

		
			
			function render() {

				renderer.render( scene, camera );

			}

			function pm(length){

				len = length || 2;
				returner = [];

				pmx.push(mouseX);
				pmy.push(mouseY);

				pmouseX = (pmx[0]);
				pmouseY = (pmy[0]);

				if(pmx.length>len)
					pmx.shift();
				if(pmy.length>len)
					pmy.shift();

				opmouseX = pmouseX-.5;
				opmouseY = pmouseY-.5;

				
			}

			function setSpan(id, str) {
			    document.getElementById(id).firstChild.nodeValue = str;
			}
				
			window.onkeyup = onKeyUp;
			
			function onKeyUp(evt) {
				console.log(evt.keyCode);

				if(evt.keyCode == 65){
					tree.position.y -= 30;
				}
				if(evt.keyCode == 81){
					tree.position.y += 30;
				}
				if(evt.keyCode == 32){
					pause = !pause;
				}
			}

			window.onmousedown = function(event) { // Mouse pressed
				mousePressed = true;
				moveMouse(this.handle, event);
			}
			window.onmouseup = function(event) {   // Mouse released
				mousePressed = false;
			}
			window.onmousemove = function(event) { // Mouse moved
				moveMouse(this.handle, event);
			}

			function moveMouse(handle, event) {
				var x = event.clientX;
				var y = event.clientY;

				var rect = event.target.getBoundingClientRect();
				if ( rect.left <= x && x <= rect.right &&
				  	rect.top  <= y && y <= rect.bottom ) {
					rmouseX = x;
					rmouseY = y;
					mouseX = x / rect.right;
					mouseY = y / rect.bottom;
					omouseX = mouseX-.5;
					omouseY = mouseY-.5;

				}
			};

		
		</script>

		
	</body>
</html>
